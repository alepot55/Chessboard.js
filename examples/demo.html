<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chessboard.js Demo</title>
  <link rel="stylesheet" href="../dist/chessboard.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      min-height: 100vh;
      padding: 20px;
      color: #fff;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 2.5rem;
      background: linear-gradient(90deg, #00d9ff, #00ff88);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .version {
      text-align: center;
      color: #888;
      margin-bottom: 30px;
    }

    .main {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .board-container {
      background: #1e1e2e;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    }

    #board {
      width: 480px;
      height: 480px;
    }

    .controls {
      background: #1e1e2e;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      min-width: 300px;
    }

    .controls h2 {
      margin-bottom: 15px;
      font-size: 1.2rem;
      color: #00d9ff;
    }

    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    button {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
    }

    .btn-primary {
      background: linear-gradient(135deg, #00d9ff, #00a8cc);
      color: #000;
    }

    .btn-secondary {
      background: #333;
      color: #fff;
    }

    .btn-success {
      background: linear-gradient(135deg, #00ff88, #00cc6a);
      color: #000;
    }

    .btn-warning {
      background: linear-gradient(135deg, #ffaa00, #ff8800);
      color: #000;
    }

    .btn-danger {
      background: linear-gradient(135deg, #ff4444, #cc0000);
      color: #fff;
    }

    .info-panel {
      background: #252535;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .info-panel h3 {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 8px;
    }

    .info-panel p {
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 0.85rem;
      word-break: break-all;
    }

    #status {
      color: #00ff88;
    }

    #fen {
      color: #ffaa00;
    }

    .move-history {
      max-height: 150px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 0.9rem;
    }

    .mode-buttons {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #333;
    }

    .mode-buttons h3 {
      margin-bottom: 10px;
      color: #888;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>â™” Chessboard.js</h1>
    <p class="version">v3.2.0 - Interactive Chess Library</p>

    <div class="main">
      <div class="board-container">
        <div id="board"></div>
      </div>

      <div class="controls">
        <h2>Controls</h2>

        <div class="btn-group">
          <button class="btn-primary" onclick="board.reset()">Reset</button>
          <button class="btn-secondary" onclick="board.clear()">Clear</button>
          <button class="btn-secondary" onclick="board.flipBoard()">Flip</button>
          <button class="btn-warning" onclick="board.undoMove()">Undo</button>
          <button class="btn-success" onclick="board.redoMove()">Redo</button>
        </div>

        <div class="btn-group">
          <button class="btn-secondary" onclick="makeRandomMove()">Random Move</button>
          <button class="btn-secondary" onclick="showLegalMoves()">Show Moves</button>
        </div>

        <div class="info-panel">
          <h3>Status</h3>
          <p id="status">Ready - White to move</p>
        </div>

        <div class="info-panel">
          <h3>FEN</h3>
          <p id="fen">-</p>
        </div>

        <div class="info-panel">
          <h3>Move History</h3>
          <div id="history" class="move-history">-</div>
        </div>

        <div class="mode-buttons">
          <h3>Game Modes</h3>
          <div class="btn-group">
            <button class="btn-success" onclick="startPvP()">PvP Mode</button>
            <button class="btn-warning" onclick="startVsBot()">Vs Bot</button>
            <button class="btn-primary" onclick="startCreative()">Creative</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="../dist/chessboard.iife.js"></script>
  <script>
    // Initialize the chessboard
    let board;
    let currentMode = null;

    function initBoard() {
      board = new Chessboard.default({
        id: 'board',
        position: 'start',
        piecesPath: '../assets/themes/default',
        draggable: true,
        clickable: true,
        onlyLegalMoves: true,
        orientation: 'w',
        onMove: (move) => {
          console.log('Move attempted:', move);
          return true;
        },
        onMoveEnd: (move) => {
          console.log('Move executed:', move);
          updateInfo();
        }
      });

      updateInfo();
      console.log('Chessboard initialized!', board);
    }

    function updateInfo() {
      const turn = board.turn();
      const turnName = turn === 'w' ? 'White' : 'Black';

      let status = `${turnName} to move`;

      if (board.isCheckmate()) {
        const winner = turn === 'w' ? 'Black' : 'White';
        status = `Checkmate! ${winner} wins!`;
      } else if (board.isGameOver()) {
        status = 'Game Over - Draw';
      } else if (board.isCheck && board.isCheck()) {
        status = `${turnName} is in check!`;
      }

      document.getElementById('status').textContent = status;
      document.getElementById('fen').textContent = board.fen();

      const history = board.getHistory();
      if (history && history.length > 0) {
        document.getElementById('history').textContent = history.map((m, i) =>
          `${Math.floor(i/2) + 1}${i % 2 === 0 ? '.' : '...'} ${m.san || m.from + m.to}`
        ).join(' ');
      } else {
        document.getElementById('history').textContent = '-';
      }
    }

    function makeRandomMove() {
      const moves = board.getLegalMoves();
      if (moves && moves.length > 0) {
        const randomMove = moves[Math.floor(Math.random() * moves.length)];
        board.movePiece(randomMove);
      }
    }

    function showLegalMoves() {
      const turn = board.turn();
      const pieces = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'];
      const ranks = ['1', '2', '3', '4', '5', '6', '7', '8'];

      let allMoves = [];
      pieces.forEach(file => {
        ranks.forEach(rank => {
          const square = file + rank;
          const moves = board.getLegalMoves(square);
          if (moves && moves.length > 0) {
            allMoves.push(`${square}: ${moves.join(', ')}`);
          }
        });
      });

      if (allMoves.length > 0) {
        alert('Legal moves:\n' + allMoves.join('\n'));
      } else {
        alert('No legal moves available');
      }
    }

    function startPvP() {
      board.startPvPMode({
        allowTakeback: true,
        allowDrawOffer: true
      });
      currentMode = board.getCurrentMode();
      document.getElementById('status').textContent = 'PvP Mode - White to move';
      console.log('PvP mode started', currentMode);
    }

    function startVsBot() {
      board.startVsBotMode({
        playerColor: 'w',
        botDifficulty: 5,
        botThinkingTime: 500,
        onBotMove: (move) => {
          console.log('Bot moved:', move);
          updateInfo();
        }
      });
      currentMode = board.getCurrentMode();
      document.getElementById('status').textContent = 'Vs Bot Mode - You are White';
      console.log('Vs Bot mode started', currentMode);
    }

    function startCreative() {
      board.startCreativeMode();
      currentMode = board.getCurrentMode();
      document.getElementById('status').textContent = 'Creative Mode - Move freely!';
      console.log('Creative mode started', currentMode);
    }

    // Initialize on load
    window.onload = initBoard;
  </script>
</body>
</html>
